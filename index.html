<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Amigo Secreto</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
    input, button { padding: 10px; font-size: 16px; margin: 10px; }
    #resultado { font-size: 22px; margin-top: 30px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>🎁 Sorteo Amigo Secreto</h1>

  <div id="login">
    <p>Escribe tu nombre exactamente como está en la lista para ingresar:</p>
    <input type="text" id="usuario" placeholder="Escribe tu nombre">
    <button onclick="ingresar()">Ingresar</button>
  </div>

  <div id="juego" style="display:none;">
    <p>Hola <span id="nombreJugador"></span>, haz clic para ver a tu Amigo Secreto:</p>
    <button id="btnVer" onclick="mostrarNombre()">Ver mi Amigo Secreto</button>
    <div id="resultado"></div>
  </div>

  <script>
    // Lista de participantes
    let participantes = [
      "Kelly", "Isabel", "Camilo", "Constanza", "Joha", "Jeico", "Susi", "Amalia", 
      "Daniel", "Daniela novia Daniel", "Susana Hija novia Daniel", "Lucy", "Andres", 
      "Isabela", "Melva", "Elkin", "Santi", "Rey", "Ines", "Daniela", "Edinson", 
      "Gerley", "John", "Samuel", "Matias"
    ];

    let asignaciones = {};
    let usuarioActual = null;

    // Genera un sorteo válido (sin repetidos y sin auto-asignación)
    function generarSorteo() {
      let nombres = [...participantes];
      let resultado = {};

      for (let persona of participantes) {
        let posibles = nombres.filter(n => n !== persona);
        if (posibles.length === 0) {
          return generarSorteo(); // reinicia si hay problema
        }
        let elegido = posibles[Math.floor(Math.random() * posibles.length)];
        resultado[persona] = elegido;
        nombres.splice(nombres.indexOf(elegido), 1);
      }
      return resultado;
    }

    // Crear sorteo al inicio
    asignaciones = generarSorteo();

    // Validar ingreso
    function ingresar() {
      let usuario = document.getElementById("usuario").value.trim();
      if (!usuario || !participantes.includes(usuario)) {
        alert("⚠️ Ingresa un nombre válido de la lista.");
        return;
      }

      // Verificar si ya consultó antes (localStorage)
      if (localStorage.getItem("jugador_" + usuario)) {
        document.getElementById("login").style.display = "none";
        document.getElementById("juego").style.display = "block";
        document.getElementById("nombreJugador").innerText = usuario;
        document.getElementById("resultado").innerText = "⚠️ Ya consultaste tu Amigo Secreto.";
        document.getElementById("btnVer").style.display = "none";
        return;
      }

      usuarioActual = usuario;
      document.getElementById("nombreJugador").innerText = usuario;
      document.getElementById("login").style.display = "none";
      document.getElementById("juego").style.display = "block";
    }

    // Mostrar el amigo secreto del jugador
    function mostrarNombre() {
      let amigo = asignaciones[usuarioActual];
      document.getElementById("resultado").innerText = "👉 " + usuarioActual + ", te tocó: " + amigo;
      localStorage.setItem("jugador_" + usuarioActual, amigo); // guardar en navegador
      document.getElementById("btnVer").style.display = "none"; // desactivar botón
    }
  </script>
</body>
</html>



